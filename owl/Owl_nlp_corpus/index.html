<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Owl_nlp_corpus (owl.Owl_nlp_corpus)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">owl</a> &#x00BB; Owl_nlp_corpus</nav><header class="odoc-preamble"><h1>Module <code><span>Owl_nlp_corpus</span></code></h1><p>NLP: Corpus module</p></header><nav class="odoc-toc"><ul><li><a href="#type-definition">Type definition</a></li><li><a href="#query-corpus">Query corpus</a></li><li><a href="#iteration-functions">Iteration functions</a></li><li><a href="#core-functions">Core functions</a></li><li><a href="#i/o-functions">I/O functions</a></li><li><a href="#helper-functions">Helper functions</a></li></ul></nav><div class="odoc-content"><h6 id="type-definition"><a href="#type-definition" class="anchor"></a>Type definition</h6><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Type of a text corpus.</p></div></div><h6 id="query-corpus"><a href="#query-corpus" class="anchor"></a>Query corpus</h6><div class="odoc-spec"><div class="spec value anchored" id="val-length"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Return the size of the corpus, i.e. number of documents.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the ith document in the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_tok"><a href="#val-get_tok" class="anchor"></a><code><span><span class="keyword">val</span> get_tok : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int array</span></span></code></div><div class="spec-doc"><p>Return the ith tokenised document in the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_uri"><a href="#val-get_uri" class="anchor"></a><code><span><span class="keyword">val</span> get_uri : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the path of the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_bin_uri"><a href="#val-get_bin_uri" class="anchor"></a><code><span><span class="keyword">val</span> get_bin_uri : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the path of the binary format of corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_bin_fh"><a href="#val-get_bin_fh" class="anchor"></a><code><span><span class="keyword">val</span> get_bin_fh : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.in_channel</span></code></div><div class="spec-doc"><p>Return the file handle of the binary formation of corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_tok_uri"><a href="#val-get_tok_uri" class="anchor"></a><code><span><span class="keyword">val</span> get_tok_uri : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the path of tokenised corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_tok_fh"><a href="#val-get_tok_fh" class="anchor"></a><code><span><span class="keyword">val</span> get_tok_fh : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.in_channel</span></code></div><div class="spec-doc"><p>Return the file handle of the tokenised corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_vocab_uri"><a href="#val-get_vocab_uri" class="anchor"></a><code><span><span class="keyword">val</span> get_vocab_uri : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the path of vocabulary file associated with the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_vocab"><a href="#val-get_vocab" class="anchor"></a><code><span><span class="keyword">val</span> get_vocab : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a></span></code></div><div class="spec-doc"><p>Return the vocabulary associated with the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_docid"><a href="#val-get_docid" class="anchor"></a><code><span><span class="keyword">val</span> get_docid : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int array</span></span></code></div><div class="spec-doc"><p>Return a list of document ids which are mapped back to the original file where the corpus is built.</p></div></div><h6 id="iteration-functions"><a href="#iteration-functions" class="anchor"></a>Iteration functions</h6><div class="odoc-spec"><div class="spec value anchored" id="val-next"><a href="#val-next" class="anchor"></a><code><span><span class="keyword">val</span> next : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return the next document in the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-next_tok"><a href="#val-next_tok" class="anchor"></a><code><span><span class="keyword">val</span> next_tok : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int array</span></span></code></div><div class="spec-doc"><p>Return the next tokenised document in the corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-iteri"><a href="#val-iteri" class="anchor"></a><code><span><span class="keyword">val</span> iteri : <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Iterate all the documents in the corpus, the index (line number) is passed in.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-iteri_tok"><a href="#val-iteri_tok" class="anchor"></a><code><span><span class="keyword">val</span> iteri_tok : <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span><span>int array</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Iterate the tokenised documents in the corpus, the index (line number) is passed in.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mapi"><a href="#val-mapi" class="anchor"></a><code><span><span class="keyword">val</span> mapi : <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> array</span></span></code></div><div class="spec-doc"><p>Map all the documents in a corpus into another array. The index (line number) is passed in.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mapi_tok"><a href="#val-mapi_tok" class="anchor"></a><code><span><span class="keyword">val</span> mapi_tok : <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> array</span></span></code></div><div class="spec-doc"><p>Map all the tokenised ocuments in a corpus into another array. The index (line number) is passed in.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-next_batch"><a href="#val-next_batch" class="anchor"></a><code><span><span class="keyword">val</span> next_batch : <span>?size:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string array</span></span></code></div><div class="spec-doc"><p>Return the next batch of documents in a corpus as a string array. The default <code>size</code> is 100.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-next_batch_tok"><a href="#val-next_batch_tok" class="anchor"></a><code><span><span class="keyword">val</span> next_batch_tok : <span>?size:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>int array</span> array</span></span></code></div><div class="spec-doc"><p>Return the next batch of tokenised documents in a corpus as a string array. The default <code>size</code> is 100.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reset_iterators"><a href="#val-reset_iterators" class="anchor"></a><code><span><span class="keyword">val</span> reset_iterators : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Reset the iterator to the beginning of the corpus.</p></div></div><h6 id="core-functions"><a href="#core-functions" class="anchor"></a>Core functions</h6><div class="odoc-spec"><div class="spec value anchored" id="val-build"><a href="#val-build" class="anchor"></a><code><span><span class="keyword">val</span> build : 
  <span>?docid:<span>int array</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?stopwords:<span><span>(string, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?lo:float <span class="arrow">&#45;&gt;</span></span>
  <span>?hi:float <span class="arrow">&#45;&gt;</span></span>
  <span>?vocab:<a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?minlen:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>This function builds up a corpus of type <code>t</code> from a given raw text corpus. We assume that each line in the raw text corpus represents a document.</p><p>Parameters: * <code>?docid</code>: passed in <code>docid</code> can be used for tracking back to the original corpus, but this is not compulsory. * <code>?stopwords</code>: stopwords used in building vocabulary. * <code>?lo</code>: any word below this lower bound of the frequency is removed from vocabulary. * <code>?hi</code>: any word above this upper bound of the frequency is removed from vocabulary. * <code>?vocab</code>: an optional vocabulary, if it is not passed, the vocabulary is built from current corpus. * <code>?(minlen=10)</code>: threshold of the document length, any document shorter than this is removed from the corpus. * <code>fname</code>: the file name of the raw text corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tokenise"><a href="#val-tokenise" class="anchor"></a><code><span><span class="keyword">val</span> tokenise : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>int array</span></span></code></div><div class="spec-doc"><p><code>tokenise corpus doc</code> tokenises the document <code>doc</code> using the <code>corpus</code> and its associated vocabulary.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unique"><a href="#val-unique" class="anchor"></a><code><span><span class="keyword">val</span> unique : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>int array</span></span></code></div><div class="spec-doc"><p>Remove the duplicates in a text corpus, the ids of the removed files are returned.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simple_process"><a href="#val-simple_process" class="anchor"></a><code><span><span class="keyword">val</span> simple_process : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Function for simple pre-processing a given string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-preprocess"><a href="#val-preprocess" class="anchor"></a><code><span><span class="keyword">val</span> preprocess : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> bytes)</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>preprocess f input_file output_file</code> pre-processes a given file <code>input_file</code> with the passed in function <code>f</code> then saves the output to <code>output_file</code>.</p><p>E.g., you can plug in <code>simple_process</code> function to clean up the text. Note this function will not change the number of lines in a corpus.</p></div></div><h6 id="i/o-functions"><a href="#i/o-functions" class="anchor"></a>I/O functions</h6><div class="odoc-spec"><div class="spec value anchored" id="val-save"><a href="#val-save" class="anchor"></a><code><span><span class="keyword">val</span> save : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Serialise the corpus and save it to a file of given name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Load a serialised corpus from a file.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-save_txt"><a href="#val-save_txt" class="anchor"></a><code><span><span class="keyword">val</span> save_txt : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Convert the tokenised corpus back to a text file</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>The string representation of a corpus, contains the summary of a corpus.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print"><a href="#val-print" class="anchor"></a><code><span><span class="keyword">val</span> print : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty print the summary of a text corpus.</p></div></div><h6 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h6><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>int array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>int array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Stdlib</span>.in_channel option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Stdlib</span>.in_channel option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span>int array</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>```create uri bin_ofs tok_ofs bin_fh tok_fh vocab minlen docid` wraps up the corpus into a record of type <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reduce_model"><a href="#val-reduce_model" class="anchor"></a><code><span><span class="keyword">val</span> reduce_model : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Set some fields to <code>None</code> so it can be safely serialised.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cleanup"><a href="#val-cleanup" class="anchor"></a><code><span><span class="keyword">val</span> cleanup : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the opened file handles associated with the corpus.</p></div></div></div></body></html>